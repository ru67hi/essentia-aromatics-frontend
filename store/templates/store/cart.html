{% extends 'store/base.html' %}
{% block content %}

<div class="container my-5">
  <h3 class="mb-4 fw-bold">Your Cart</h3>

  {% if cart_items %}
    <div class="card shadow-sm">
      <div class="card-body">

        {% for item in cart_items %}
        <div class="row align-items-center border-bottom py-3">

          <!-- Product Image -->
          <div class="col-md-2 text-center">
            <img src="{{ item.product.image.url }}"
                 class="img-fluid rounded"
                 style="width:80px; height:80px; object-fit:cover;">
          </div>

          <!-- Product Info -->
          <div class="col-md-4">
            <h6 class="fw-bold mb-1">{{ item.product.name }}</h6>
            <p class="text-muted mb-0">₹ {{ item.product.price }}</p>
          </div>

          <!-- Quantity Controls -->
          <div class="col-md-3 text-center">
            <div class="btn-group" role="group">
              <a href="{% url 'decrease_qty' item.id %}"
                 class="btn btn-outline-secondary btn-sm">−</a>

              <span class="btn btn-light btn-sm disabled">
                {{ item.quantity }}
              </span>

              <a href="{% url 'increase_qty' item.id %}"
                 class="btn btn-outline-secondary btn-sm">+</a>
            </div>
          </div>

          <!-- Price + Remove -->
          <div class="col-md-3 text-end">
            <p class="fw-bold mb-2">
              ₹ {{ item.subtotal }}
            </p>
            <a href="{% url 'remove_from_cart' item.id %}"
               class="btn btn-sm btn-outline-danger">
              Remove
            </a>
          </div>

        </div>
        {% endfor %}

      </div>
    </div>

  {% else %}
    <p>Your cart is empty.</p>
  {% endif %}
</div>

<div class="col-md-4">
  <div class="card shadow">
    <div class="card-body">

      <h5 class="fw-bold mb-3">Order Summary</h5>

      <p>Subtotal: ₹ {{ subtotal }}</p>
      <p>Discount: − ₹ {{ discount }}</p>
      <p>GST (5%): ₹ {{ gst }}</p>
      <p>Delivery: ₹ {{ delivery_fee }}</p>

      <hr>
      <h5>Total: ₹ {{ grand_total }}</h5>

      <form method="post" class="mt-3">
        {% csrf_token %}
        <input type="text" name="coupon"
               class="form-control mb-2"
               placeholder="Enter coupon">
        <button class="btn btn-outline-dark w-100">
          Apply Coupon
        </button>
      </form>

      <a href="{% url 'checkout' %}"
         class="btn btn-success w-100 mt-3">
         Proceed to Pay
      </a>
      

    </div>
  </div>
</div>

{% endblock %}
